컴퓨터의 장치들은 I/O 버스에 연결되어 장치간 데이터 전송이 이루어진다.



입출력 장치들은 다른 장치와 인터랙션하기 위해 내부적으로 버스 인터페이스를 가지고 있으며 시스템 버스, 데이터 버스, 어드레드 버스, 컨트롤 버스 등에 연결되어 있다.



입출력 장치 내부의 레지스터

- status register: 장치의 상태를 보여주는 레지스터
- control register: 장치의 동작을 결정하는 레지스터
- data register: 입출력할 데이터를 잠시 보관하는 레지스터



입출력 장치의 레지스터에 접근하는 두 가지 방법

1. mamory-mapped I/O
2. port-mapped I/O

운영체제가 장치들을 제어 한다는것은 결국엔 디바이스에 존재하는 레지스터를 프로그래밍 하는 것이다.



입출력 장치 구분

- character device
  - mouse
  - terminal
- block device
  - disk drive
  - flash drive
- network device
  - nic(network interface card)



마우스

GUI 를 지원하는 운영체제가 등장함에 따라 마우스가 사용되기 시작함.

광학 마우스

카메라 = 레이저 + 센서

PC mouse system ( data transfer chain)

- 센서
- 마우스 컨트롤러
- 커뮤니케이션 링크
- 데이터 인터페이스
- 디바이스 드라이버
- 애플리케이션



입출력 장치는 좌표나 값 등을 전송한다.

운영체제, 애플리케이션 처럼 추상과 단계가 높아짐에 따라 이벤트, 메시지 등으로 네이밍이 변화한다.

인터럽트는 하드웨어적으로 처리되지만 이벤트는 소프트웨어적으로 처리된다.

인터럽트(하드웨어) <> 이벤트(소프트웨어) 사이의 변환이 필요하고 이는 대체적으로 디바이스 드라이버가 담당한다.

마우스 드라이버의 역할

- 마우스 인터럽트 발생 시, 마우스의 데이터 레지스터의 값을 읽어오는 역할
- 인터럽트를 이벤트로 바꾸어 주는 역할



터미널

터미널 = 키보드 + 디스플레이. 두 장치는 독립적으로 동작.

키보드 드라이버의 역할

- 키보드로부터 들어오는 각 캐릭터들을 라인 버퍼에 순서대로 저장
- end of line 캐릭터(EOF)가 들어오면 전체 라인 버퍼를 운영체제에게 전달



디스크 드라이버

spindle: 디스크의 회전 축

arm assembly: spindle 과 평행하게 위치하여 디스크와 가까워 지거나 멀어지는 동작

header: 디스크의 위 아래 하나씩 존재하여 디스크에 대한 read write 수행

track: 한 디스크 표면에서 스핀들로부터의 거리가 동일한 환형의 저장공간. 반지름이 동일한 공간.

cylinder: 여러 장의 디스크에 수직으로 쌓여 있는 동일한 반지름의 track 들의 집합.

sector: 트랙을 분할하는 디스크 read write 의 단위 영역



실린더 단위의 데이터 접근이 중요한 이유

암 어셈블리가 고정된 상태에서 여러 platter 에 걸쳐 있는 한 실린더의 트랙들을 동시에 읽을 수 있기 때문



섹터의 주소는 3차원 구조. 디스가 3차원 구조이기 때문.

sector 주소의 구성

- 실린더 넘버
- 트랙 넘버
- 섹터 넘버

섹터의 사이즈는 대략적으로 0.5 ~ 4 K. 데이터 전송이 발생하는 최소 단위.



디스크 오퍼레이션

- 암 어셈블리를 해당 실린더로 이동(seek)
  - seek time: 암을 목표한 지점(해당 실린더) 까지 이동하는데 걸리는 시간. 디스크 액세스 시간이 오래 걸리는 이유.
- rotational delay: 디스크가 회전하여 목표한 지점(sector)이 헤드에 도차하는 시간
- transfer latency

퍼포먼스

- seek time: 0~50ms (average 10~20ms)
- rotational delay: 0~16ms
- typical drive spins at 3600~5400 RPM



플래시 드라이브

erase-before-write

낸드 플래시 메모리는 데이터의 덮어쓰기가 불가능하기 때문에 먼저 데이터를 erase 한 후에 write 를 해야 한다.

worn-out

이레이즈 가능한 횟수에 제한이 있다.

wear-leveling

낸드 플래시의 한 영역에 erase 가 집중되어 worn-out 이 발생하는 것을 막기 위해 전체 영역을 골고루 사용하도록 조절하는 기법

read와 write 의 단위는 page. erase의 단위는 block



디바이스 드라이버

입출력 장치를 통제하고 운영하는 소프트웨어

다른 프로그램들이 하드웨어 디바이스를 잘 사용하도록 도와주는 컴퓨터 프로그램

